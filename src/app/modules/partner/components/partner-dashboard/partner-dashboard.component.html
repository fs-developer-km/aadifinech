<div class="dashboard-wrapper">
  
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loader-spinner"></div>
    <p class="loading-text">Loading your dashboard...</p>
  </div>

  <!-- Main Dashboard Content -->
  <div *ngIf="!isLoading && partnerData" class="dashboard-content">
    
    <!-- Header Section -->
    <div class="header-banner">
      <div class="header-left">
        <div class="avatar-circle">{{ getInitials(partnerData.name) }}</div>
        <div class="header-info">
          <h1 class="greeting-text">{{ greeting }}, {{ partnerData.name }}!</h1>
          <p class="partner-id">Partner ID: <span class="id-badge">{{ partnerData._id.slice(-8).toUpperCase() }}</span></p>
        </div>
      </div>
      <div class="status-container">
        <div class="status-badge" [ngClass]="getStatusClass(partnerData.accountStatus)">
          <i [class]="'fas ' + getStatusIcon(partnerData.accountStatus)"></i>
          {{ partnerData.accountStatus }}
        </div>
      </div>
    </div>

    <!-- Quick Stats Grid -->
    <div class="stats-container">
      <div class="stat-box">
        <div class="stat-icon-wrapper blue-gradient">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-details">
          <p class="stat-title">Member Since</p>
          <p class="stat-number">{{ getDaysSinceRegistration() }} Days</p>
          <p class="stat-meta">{{ formatDate(partnerData.signupDate) }}</p>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon-wrapper purple-gradient">
          <i class="fas fa-sign-in-alt"></i>
        </div>
        <div class="stat-details">
          <p class="stat-title">Total Logins</p>
          <p class="stat-number">{{ partnerData.loginCount }}</p>
          <p class="stat-meta">Last: {{ partnerData.lastLoginTime || 'N/A' }}</p>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon-wrapper green-gradient">
          <i class="fas fa-rupee-sign"></i>
        </div>
        <div class="stat-details">
          <p class="stat-title">Commission</p>
          <p class="stat-number">{{ formatCommissionValue(partnerData.commissionValue) }}</p>
          <p class="stat-meta">{{ partnerData.commissionType || 'N/A' }}</p>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon-wrapper orange-gradient">
          <i class="fas fa-briefcase"></i>
        </div>
        <div class="stat-details">
          <p class="stat-title">Business Type</p>
          <p class="stat-number small-text">{{ partnerData.businessType || 'N/A' }}</p>
          <p class="stat-meta">{{ partnerData.companyName || 'N/A' }}</p>
        </div>
      </div>
    </div>

    <!-- Main Content Grid -->
    <div class="content-grid">
      
      <!-- Personal Information Card -->
      <div class="info-card">
        <div class="card-header primary-header">
          <i class="fas fa-user-circle"></i>
          <h3>Personal Information</h3>
        </div>
        <div class="card-content">
          <div class="info-item">
            <span class="info-label"><i class="fas fa-user"></i> Full Name</span>
            <span class="info-value">{{ partnerData.name }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-mobile-alt"></i> Mobile</span>
            <span class="info-value">{{ partnerData.mobile }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-id-badge"></i> Role</span>
            <span class="info-value capitalize">{{ partnerData.role }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-calendar-alt"></i> Joined On</span>
            <span class="info-value">{{ formatDate(partnerData.signupDate) }}</span>
          </div>
        </div>
      </div>

      <!-- Business Details Card -->
      <div class="info-card">
        <div class="card-header secondary-header">
          <i class="fas fa-building"></i>
          <h3>Business Details</h3>
        </div>
        <div class="card-content">
          <div class="info-item">
            <span class="info-label"><i class="fas fa-store"></i> Company</span>
            <span class="info-value">{{ partnerData.companyName || 'Not Provided' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-industry"></i> Type</span>
            <span class="info-value">{{ partnerData.businessType || 'Not Provided' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-file-invoice"></i> GST Number</span>
            <span class="info-value">{{ partnerData.gstNumber || 'Not Provided' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-percent"></i> Commission</span>
            <span class="info-value capitalize">{{ partnerData.commissionType || 'N/A' }}</span>
          </div>
        </div>
      </div>

      <!-- Assigned Employee Card -->
      <div class="info-card" [ngClass]="{'no-data-card': !hasAssignedEmployee()}">
        <div class="card-header employee-header">
          <i class="fas fa-user-tie"></i>
          <h3>Assigned Employee</h3>
        </div>
        <div class="card-content">
          <div *ngIf="hasAssignedEmployee()" class="team-member-section">
            <div class="member-profile">
              <div class="member-avatar blue-bg">{{ getEmployeeInitials() }}</div>
              <div class="member-info">
                <h4 class="member-name">{{ getEmployee()?.name }}</h4>
                <p class="member-code" *ngIf="getEmployee()?.employeeCode">
                  <i class="fas fa-hashtag"></i> {{ getEmployee()?.employeeCode }}
                </p>
              </div>
            </div>
            <div class="member-details">
              <div class="detail-row" *ngIf="getEmployee()?.department">
                <span class="detail-icon"><i class="fas fa-sitemap"></i></span>
                <div class="detail-text">
                  <p class="detail-label">Department</p>
                  <p class="detail-value">{{ getEmployee()?.department }}</p>
                </div>
              </div>
              <div class="detail-row" *ngIf="getEmployee()?.designation">
                <span class="detail-icon"><i class="fas fa-briefcase"></i></span>
                <div class="detail-text">
                  <p class="detail-label">Designation</p>
                  <p class="detail-value">{{ getEmployee()?.designation }}</p>
                </div>
              </div>
              <div class="detail-row" *ngIf="getEmployee()?.mobile">
                <span class="detail-icon"><i class="fas fa-phone"></i></span>
                <div class="detail-text">
                  <p class="detail-label">Contact</p>
                  <p class="detail-value">{{ getEmployee()?.mobile }}</p>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="!hasAssignedEmployee()" class="no-data-state">
            <i class="fas fa-user-slash"></i>
            <p>No employee assigned yet</p>
            <span class="no-data-info">An employee will be assigned soon</span>
          </div>
        </div>
      </div>

      <!-- Assigned Manager Card -->
      <div class="info-card" [ngClass]="{'no-data-card': !hasAssignedManager()}">
        <div class="card-header manager-header">
          <i class="fas fa-user-shield"></i>
          <h3>Assigned Manager</h3>
        </div>
        <div class="card-content">
          <div *ngIf="hasAssignedManager()" class="team-member-section">
            <div class="member-profile">
              <div class="member-avatar purple-bg">{{ getManagerInitials() }}</div>
              <div class="member-info">
                <h4 class="member-name">{{ getManager()?.name }}</h4>
                <p class="member-code" *ngIf="getManager()?.employeeCode">
                  <i class="fas fa-hashtag"></i> {{ getManager()?.employeeCode }}
                </p>
              </div>
            </div>
            <div class="member-details">
              <div class="detail-row" *ngIf="getManager()?.department">
                <span class="detail-icon"><i class="fas fa-sitemap"></i></span>
                <div class="detail-text">
                  <p class="detail-label">Department</p>
                  <p class="detail-value">{{ getManager()?.department }}</p>
                </div>
              </div>
              <div class="detail-row" *ngIf="getManager()?.designation">
                <span class="detail-icon"><i class="fas fa-briefcase"></i></span>
                <div class="detail-text">
                  <p class="detail-label">Designation</p>
                  <p class="detail-value">{{ getManager()?.designation }}</p>
                </div>
              </div>
              <div class="detail-row" *ngIf="getManager()?.mobile">
                <span class="detail-icon"><i class="fas fa-phone"></i></span>
                <div class="detail-text">
                  <p class="detail-label">Contact</p>
                  <p class="detail-value">{{ getManager()?.mobile }}</p>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="!hasAssignedManager()" class="no-data-state">
            <i class="fas fa-user-slash"></i>
            <p>No manager assigned yet</p>
            <span class="no-data-info">A manager will be assigned soon</span>
          </div>
        </div>
      </div>

    </div>

    <!-- Address Section -->
    <div class="address-section">
      <div class="card-header address-header">
        <i class="fas fa-map-marker-alt"></i>
        <h3>Business Address</h3>
      </div>
      <div class="address-content">
        <div class="address-icon">
          <i class="fas fa-map-marked-alt"></i>
        </div>
        <p class="address-text">{{ partnerData.address || 'No address provided' }}</p>
      </div>
    </div>

    <!-- Activity Timeline -->
    <div class="activity-section">
      <div class="section-header">
        <i class="fas fa-history"></i>
        <h3>Activity Timeline</h3>
      </div>
      <div class="timeline-grid">
        
        <div class="timeline-card">
          <div class="timeline-icon blue-bg">
            <i class="fas fa-user-plus"></i>
          </div>
          <div class="timeline-info">
            <p class="timeline-title">Account Created</p>
            <p class="timeline-date">{{ formatDate(partnerData.signupDate) }}</p>
          </div>
        </div>

        <div class="timeline-card">
          <div class="timeline-icon purple-bg">
            <i class="fas fa-sign-in-alt"></i>
          </div>
          <div class="timeline-info">
            <p class="timeline-title">Last Login</p>
            <p class="timeline-date">{{ formatDate(partnerData.lastLoginDate) }}</p>
            <p class="timeline-time">{{ partnerData.lastLoginTime }}</p>
          </div>
        </div>

        <div class="timeline-card">
          <div class="timeline-icon green-bg">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="timeline-info">
            <p class="timeline-title">Total Sessions</p>
            <p class="timeline-date">{{ partnerData.loginCount }} logins</p>
          </div>
        </div>

        <div class="timeline-card">
          <div class="timeline-icon orange-bg">
            <i class="fas fa-sync-alt"></i>
          </div>
          <div class="timeline-info">
            <p class="timeline-title">Last Updated</p>
            <p class="timeline-date">{{ formatDate(partnerData.updatedAt) }}</p>
          </div>
        </div>

      </div>
    </div>

    <!-- Company Branding Footer -->
    <div class="company-footer">
      <div class="footer-content">
        <div class="company-logo">
          <i class="fas fa-university"></i>
          <span class="company-name">AadiFintech</span>
        </div>
        <p class="footer-tagline">Your Trusted Financial Partner</p>
      </div>
    </div>

  </div>

  <!-- Error State -->
  <div *ngIf="!isLoading && !partnerData" class="error-container">
    <div class="error-icon">
      <i class="fas fa-exclamation-circle"></i>
    </div>
    <h2 class="error-title">Unable to Load Dashboard</h2>
    <p class="error-message">Please check your connection and try again</p>
    <button class="retry-button" (click)="fetchPartnerData()">
      <i class="fas fa-redo-alt"></i>
      Retry
    </button>
  </div>

</div>